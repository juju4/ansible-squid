[Service]
NoNewPrivileges=yes
PrivateTmp=true
ProtectHome=read-only
ProtectSystem=full
{% if (ansible_os_family == 'RedHat' and ansible_distribution_major_version|int >= 7) or (ansible_distribution == "Ubuntu" and ansible_distribution_major_version|int >= 18) %}
ProtectKernelTunables=true
RestrictRealtime=true
{% endif %}
RestrictAddressFamilies=AF_INET AF_INET6 AF_UNIX
{% if not (ansible_virtualization_type is defined and
          (ansible_virtualization_type == "lxc" or ansible_virtualization_type == "docker")
        ) and
      not (ansible_os_family == 'RedHat' and ansible_distribution_major_version|int < 8) %}
SystemCallFilter=mprotect mmap read brk 36 setresuid fstat prctl close futex capset write setgid setgroups munmap socket lseek getpid setsockopt sysinfo poll flock capget rt_sigaction rt_sigprocmask kill umask getuid arch_prctl set_robust_list prlimit64 geteuid set_tid_address stat execve access openat connect setgroups setsid sendto dup2 ftruncate fsync statfs clone unlink wait4 alarm fcntl chdir epoll_create bind getsockname epoll_ctl pipe setuid select dup recvfrom rename listen epoll_wait accept fchmod ioctl getsockopt getdents getrusage uname getrandom sendmmsg
{% if (ansible_os_family == 'RedHat' and ansible_distribution_major_version|int >= 8) or (ansible_distribution == "Ubuntu" and ansible_distribution_major_version|int >= 18) %}
#SystemCallFilter=~@debug @mount @cpu-emulation @obsolete @privileged
SystemCallFilter=~@debug @mount @cpu-emulation @obsolete
{% endif %}
{% endif %}
